#macro( htmlColor $color )
	$fmt.format("#%02x%02x%02x", $color.Red, $color.Green, $color.Blue)
#end

<?xml version="1.0"?>
<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
	<link href="style/reset.css" rel="stylesheet" type="text/css" media="all" />
	<link href="style/default.css" rel="stylesheet" type="text/css" media="screen" />
	<link href="style/styling.css" rel="stylesheet" type="text/css" media="screen" />
	<link href="style/print.css" rel="stylesheet" type="text/css" media="print" />
	
	#set( $cellSize = $figure.cellSize )
	
	<style type="text/css">
		.mtt {
			border-style: solid;
			
			#if( $figure.showGrid )
				border-width: 1px;
				border-color: #htmlColor( $figure.gridColor )
    		#else
				border-width: 0px;
    		#end
		}
		
		.mtd {
			border-style: solid;
			width: ${cellSize}px; 
			height: ${cellSize}px;
			white-space:nowrap;
			
    		#if( $figure.showGrid )
				border-width: 1px;
				border-color: #htmlColor( $figure.gridColor )
    		#else
				border-width: 0px;
    		#end
		}
    </style>
</head>
<body class="fullwidth">
	<div id="container">
		<div id="header">
			<div id="header-in">
				#if( $figure.title && $figure.title.length() > 0 )
            		<h1>$figure.title</h1>
            	#end
			</div> <!-- end #header-in -->
		</div> <!-- end #header -->

		<div id="content-wrap" class="clear">
			<div class="content">
				<div class="content-in">

	#if( $figure.description && $figure.description.length() > 0 )
		<h2>Notes</h2>
		<p>$figure.description</p>
	#end
	
	#set( $cellDecorator = $figure.cellDecorator )
	
	<h2>Figure</h2>
	
	<table class="mtt">
		#set( $colAdapter = $matrix.columnAdapter )
		#set( $rowAdapter = $matrix.rowAdapter )
		#set( $cellAdapter = $matrix.cellAdapter )
		
		#set( $lastRow = $matrix.rowCount - 1 )
		#set( $lastColumn = $matrix.columnCount - 1 )
		
		## Header
		
		<tr>
			#foreach( $ci in [0..$lastColumn] )
				#set( $col = $matrix.getColumn($ci) )
				#set( $colName = $colAdapter.getValue($col, 0) )
				<td class="mtd"
					style="vertical-align: top; text-align: center;">
					#foreach( $ch in $colName.toCharArray() )
						$ch<br/>
					#end
				</td>
			#end
            <td class="mtd"></td>
        </tr>
		
		## Body
		
		#foreach( $ri in [0..$lastRow] )
			<tr>
				## Cells
				#foreach( $ci in [0..$lastColumn] )
					#set( $cell = $matrix.getCell($ri, $ci) )
					$cellDecorator.decorate($cellDecoration, $cell)
					#set( $bgColor = $cellDecoration.bgColor )
					<td class="mtd"
						style="background-color: #htmlColor($bgColor);"
						title="$cellDecoration.toolTip"></td>
				#end
				
				## Row
    			#set( $row = $matrix.getRow($ri) )
    			#set( $rowName = $rowAdapter.getValue($row, 0) )
    			<td class="mtd">$rowName</td>
            </tr>
		#end
    </table>
	
				</div> <!-- end .content-in -->
			</div> <!-- end .content -->
		</div> <!-- end #content-wrap -->

		<div class="clear"></div>

		<div id="footer">
			<div id="footer-in">
				Generated by GiTools
			</div> <!-- end #footer-in -->
		</div> <!-- end #footer -->
	</div> <!-- end div#container -->
</body>
</html>